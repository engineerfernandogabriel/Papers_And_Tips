Entendendo o Maven

Como desenvolvedor Java, voc√™ provavelmente j√° ouviu falar muito sobre o Maven ao longo da sua carreira. Mas afinal, o que √© o Maven e qual √© o seu papel? Neste artigo, vamos explorar alguns conceitos importantes sobre o Maven e examinar suas aplica√ß√µes na automa√ß√£o.
Ent√£o, o que √© o Apache Maven?
Conforme indicado no site https://maven.apache.org/, o Apache Maven atua como uma ferramenta de gerenciamento e compreens√£o de projetos de software. Utilizando o conceito de um modelo de objeto de projeto (POM), o Maven facilita o gerenciamento do processo de constru√ß√£o, relat√≥rios e documenta√ß√£o de um projeto a partir de uma fonte centralizada de informa√ß√µes.
Ao olharmos de forma mais abrangente para o Apache Maven:
Funciona como uma ferramenta de gerenciamento de projeto centrada em um modelo de objeto de projeto.
Segue um conjunto de padr√µes.
Adere a um ciclo de vida do projeto.
Inclui um sistema de gerenciamento de depend√™ncias.
Emprega l√≥gica para executar metas de plugins em v√°rias fases do ciclo de vida do projeto.
Com esses recursos, o Maven possibilita configura√ß√µes de projetos simples que seguem as melhores pr√°ticas. Ao utilizar o Maven, os projetos podem manter uma estrutura consistente independente de IDEs espec√≠ficos. Al√©m disso, uma das fun√ß√µes mais cruciais do Maven √© simplificar a declara√ß√£o de depend√™ncias do projeto.
Aprofundando este aspecto, ao desenvolver uma aplica√ß√£o Java tradicional, gerenciar depend√™ncias geralmente envolve o download e a incorpora√ß√£o manual delas na estrutura do projeto. Esse processo pode ser trabalhoso e propenso a erros. Al√©m disso, acompanhar as vers√µes das depend√™ncias √© essencial para a estabilidade do projeto. √â aqui que o Maven se mostra inestim√°vel. Ele n√£o apenas rastreia depend√™ncias e suas vers√µes, mas tamb√©m as baixa automaticamente quando necess√°rio para construir o projeto.
O Maven realiza isso por meio de um arquivo dedicado conhecido como pom.xml, simplificando significativamente o gerenciamento de depend√™ncias do projeto.
Instalando o Maven
Para come√ßar a usar o Apache Maven, visite https://maven.apache.org/ e selecione o link para Download. Voc√™ o encontrar√° tanto no painel lateral quanto na se√ß√£o Download, Instala√ß√£o, Execu√ß√£o do Maven no conte√∫do.

P√°gina inicial do Maven

Quando voc√™ clicar nesse link, ser√° direcionado para a p√°gina de downloads, onde encontrar√° os requisitos do sistema para o Maven (Sempre tente baixar a vers√£o mais recente do Maven). O requisito mais importante aqui √© a vers√£o do JDK. Atualmente, a vers√£o mais recente do Maven √© a 3.9.6 e a vers√£o do JDK necess√°ria para isso √© a JDK 1.8.

Requisitos para instalar o Maven

Ao rolar para baixo, voc√™ encontrar√° as instru√ß√µes de instala√ß√£o e os arquivos para download. Neste ponto, vamos selecionar o arquivo apache-maven-3.9.6-bin.zip e revisar as instru√ß√µes de instala√ß√£o posteriormente.

Download Maven 3.9.6

Agora v√° para a p√°gina de instru√ß√µes de instala√ß√£o. L√°, voc√™ encontrar√° as orienta√ß√µes sobre como instalar o Apache Maven em sua m√°quina local.

Link para a p√°gina de instru√ß√µes de instala√ß√£o

P√°gina de instru√ß√µes de instala√ß√£o

Conforme as instru√ß√µes, primeiro, descompacte o arquivo zip baixado. Ap√≥s descompactar o arquivo, voc√™ ter√° um diret√≥rio chamado apache-maven-3.9.6. 
Aqui, vamos ver como instalar isso em um computador com Windows.
Crie um diret√≥rio (pasta) "maven" em C:\Program Files (C:\Arquivos de Programas). 
Copie ou recorte o arquivo descompactado apache-maven-3.9.6 e cole dentro do diret√≥rio maven criado no C:.
Digite "vari√°veis de ambiente" na pesquisa do Windows na sua barra de tarefas e abra para editar as vari√°veis de ambiente do sistema.
Clique em "Vari√°veis de Ambiente" e depois em "Novo" em Vari√°veis do Sistema. Para o nome da vari√°vel, insira MAVEN_HOME e, para o valor, insira o caminho do diret√≥rio que criou (C:\Program Files\maven\apache-maven-3.9.6).
Em seguida, selecione a vari√°vel Path em Vari√°veis do Sistema e clique em Editar. Depois, clique em Novo na janela que aparecer e digite %MAVEN_HOME%\bin. Em seguida, clique em OK.

Telas de configura√ß√µes de vari√°veis de ambiente

Agora voc√™ pode abrir o prompt de comando e digitar "mvn -v" para verificar se o Maven foi adicionado ao seu caminho ou n√£o.

prompt com a vers√£o do maven

Eu j√° instalei o Java e o adicionei ao caminho. Voc√™ pode instalar o Oracle JDK ou o Open JDK para o Java e configur√°-lo na vari√°vel de caminho definindo uma nova vari√°vel JAVA_HOME, conforme discutimos anteriormente. Voc√™ pode verificar se as vari√°veis est√£o funcionando digitando echo %JAVA_HOME% e echo %MAVEN_HOME% no seu prompt de comando.

Entendendo Maven - POM
Como mencionado anteriormente, o Maven trabalha com um modelo de objeto de projeto ou POM. De acordo com o Github, "Introduzindo o Apache Maven",
POM significa Project Object Model. Este modelo possui um conjunto de padr√µes, um ciclo de vida do projeto, um sistema de gerenciamento de depend√™ncias e uma l√≥gica para executar metas de plugins em fases definidas em um ciclo de vida.
Ao criar um projeto Java usando o Maven, podem ser observadas as seguintes caracter√≠sticas.
Os projetos s√£o configurados com comportamentos padr√£o. 
O c√≥digo fonte deve estar na pasta src/main. 
Os recursos necess√°rios para o projeto est√£o em outra pasta. 
Os casos de teste est√£o em uma pasta especificamente nomeada. 
A pasta alvo √© usada para o arquivo JAR final.
Vamos analisar a estrutura de um projeto e ter uma ideia b√°sica sobre o Maven e o arquivo POM.

Entendendo Maven - Demonstra√ß√£o de Amostra 
Para ter uma ideia b√°sica sobre o Maven, vamos criar um projeto Maven simples usando o inicializador do Spring. Voc√™ pode usar um IDE como o IntelliJ, VSCode Studio ou usar o site start.spring.io. Aqui, usarei o site start.spring.io, j√° que o Maven √© independente do IDE.


Aqui, voc√™ pode ver que para o nome do artefato, escolhemos "example-maven" e selecionei o Java 17 para a vers√£o do Java, Spring 3.2.5. Para as depend√™ncias, adicionei Spring Web, Spring Data JPA, Lombok e Rest Repositories. Agora, clique no bot√£o Gerar e um arquivo zip ser√° baixado. Extraia o arquivo zip e abra-o usando um IDE de sua prefer√™ncia. Eu vou usar o IntelliJ e vou abrir usando o arquivo pom.xml.
Levar√° alguns segundos para sincronizar e depois disso, voc√™ poder√° ver a seguinte estrutura de projeto.

Intellij com o arquivo gerado pelo spring inicializador aberto
Aqui, no arquivo pom.xml aberto, voc√™ pode ver as especifica√ß√µes que voc√™ definiu durante a inicializa√ß√£o do projeto no inicializador do Spring.

Entendendo Maven - Ciclo de Vida do Maven 
Se voc√™ abrir o bot√£o do menu lateral chamado Maven, poder√° ver as fases no Ciclo de Vida do Maven. Existem nove fases importantes no Ciclo de Vida do Maven.

Janela com o lifeCycle do maven aberta

clean - limpa o diret√≥rio target onde o Maven normalmente constr√≥i seu projeto 
validate - valida se o projeto est√° correto 
compile - compila o c√≥digo-fonte do projeto 
test - testa o c√≥digo-fonte compilado usando um framework de teste unit√°rio 
package - empacota o c√≥digo compilado 
verify - executa verifica√ß√µes para garantir que o pacote seja v√°lido 
install - instala o pacote no reposit√≥rio local 
deploy - copia o pacote final para um reposit√≥rio remoto 
integration-test (n√£o neste projeto) - implanta o pacote em um ambiente onde os testes de integra√ß√£o podem ser executados
Como os objetivos do plugin podem ser associados a cada fase do ciclo de vida, o Maven executa os objetivos associados a cada fase. E uma fase pode ter zero ou mais objetivos. Por exemplo, se voc√™ abrir o terminal dentro do IDE e digitar mvn install, v√°rios objetivos ser√£o executados. Por enquanto, vamos pular a fase de testes e executar o Maven dentro do nosso IDE. Para fazer isso, abra o terminal e digite "mvn clean install -DskipTests".

Tela com sucesso de build
Quando voc√™ executa isso, perceber√° que todas as depend√™ncias mencionadas no arquivo pom.xml s√£o baixadas para o seu projeto e o projeto √© agrupado em um arquivo .jar (na pasta target).
Voc√™ pode encontrar o arquivo agrupado na pasta target, bem como na pasta .m2. Voc√™ pode acessar a pasta .m2 indo para C:\Usu√°rios\<NOME_DO_USU√ÅRIO>\.m2

Entendendo Maven - Reposit√≥rios Maven 
Quando se trata do Maven, existem dois reposit√≥rios: o Reposit√≥rio Central do Maven e o reposit√≥rio local .m2.
Olhando para o Reposit√≥rio Central do Maven, voc√™ pode visitar o site usando o search.maven.org, mvnrepository.com. √â o reposit√≥rio que cont√©m todas as depend√™ncias mencionadas no arquivo pom.xml.

Tela inicial search maven

Tela inicial mvnrepository
E o reposit√≥rio .m2 √© o reposit√≥rio local que est√° em sua m√°quina local. Portanto, quando voc√™ executa o comando mvn clean install, que executamos anteriormente, a m√°quina local se conecta ao Maven Central e baixa todas as depend√™ncias mencionadas no arquivo pom.xml para o seu reposit√≥rio .m2 local. E ap√≥s isso, essas depend√™ncias s√£o adicionadas √† pasta de Bibliotecas Externas em seu projeto, resolvendo assim o problema do gerenciamento de depend√™ncias.

Entendendo o pom.xml 
Como mencionamos acima, o arquivo pom.xml cont√©m todas as informa√ß√µes sobre um projeto. Mesmo que voc√™ n√£o tenha adicionado nenhuma depend√™ncia, voc√™ pode criar o arquivo pom.xml e adicionar suas depend√™ncias posteriormente. O arquivo pom.xml mais simples que voc√™ pode ter parece com isso.

arquivo pom.xml inicial simples
Os elementos <groupId></groupId>, <artifactId></artifactId> e <version></version> formam o projeto. Portanto, eles s√£o essenciais ao criar um projeto Maven. Frequentemente, esses elementos s√£o mencionados como coordenadas do projeto.
O arquivo pom.xml √© um arquivo XML (Extensible Markup Language) que tem uma sintaxe semelhante ao HTML. E se voc√™ tiver v√°rios projetos dentro de um projeto Maven, todos esses projetos estendem automaticamente o super POM.
Quando voc√™ est√° adicionando depend√™ncias ao seu arquivo pom.xml, voc√™ precisa adicion√°-las ao grupo nomeado <dependencies></dependencies>. Um exemplo simples disso √© mostrado abaixo

exemplo de inser√ß√£o de depend√™ncias dentro do pom
Ao usar depend√™ncias, voc√™ pode usar a tag <scope></scope> para definir o escopo no qual deseja que essa depend√™ncia seja executada. Por exemplo, a depend√™ncia do JUnit pode ter <scope>test</scope> pois pode ser usada para a fase de teste. Existem outros escopos como compile, provided, runtime e system.
compile - escopo padr√£o 
provided - quando √© esperado que o JDK as forne√ßa 
runtime - para execu√ß√£o e teste, n√£o para compila√ß√£o 
test - durante os testes, n√£o necess√°rio durante a opera√ß√£o normal 
system - similar a "provided", mas √© necess√°rio especificar o caminho expl√≠cito para o JAR em um sistema de arquivos local 
Para aprender mais detalhadamente sobre os escopos, leia o artigo:
https://howtodoinjava.com/maven/maven-dependency-scopes/

Agora, vamos dar uma olhada nos plugins do Maven. Um plugin √© uma cole√ß√£o de um ou mais objetivos e um objetivo √© uma unidade de trabalho no Maven. Existem muitos plugins principais como o plugin JAR, Plugin do Compilador, Plugin Surefire, etc. Al√©m disso, o Maven permite que os usu√°rios criem plugins personalizados tamb√©m. Para ver a lista completa dos plugins principais, acesse https://maven.apache.org/plugins/index.html
Por exemplo, para utilizar o plugin do compilador, voc√™ pode digitar mvn compiler:compile. Aqui, compile √© o objetivo fornecido.

Build succes do comando compiler

CONCLUS√ÉO
Em suma, o arquivo pom.xml do Maven √© o cora√ß√£o de qualquer projeto Maven, pois cont√©m todas as configura√ß√µes e informa√ß√µes necess√°rias para construir e gerenciar o projeto de forma eficiente. Atrav√©s do POM, podemos definir depend√™ncias, plugins, perfis e muitos outros aspectos fundamentais do projeto. Dominar o pom.xml √© essencial para maximizar a produtividade e facilitar o desenvolvimento de software utilizando o Maven. Com uma compreens√£o s√≥lida do POM e suas nuances, os desenvolvedores podem garantir uma constru√ß√£o consistente e confi√°vel de seus projetos, adaptando-se √†s necessidades espec√≠ficas de cada projeto.
1. Estrutura B√°sica:
project: Define informa√ß√µes gerais do projeto, como groupId, artifactId, version, e packaging.
dependencies: Lista as depend√™ncias externas necess√°rias para o projeto funcionar (bibliotecas, frameworks, etc.).
repositories: Define reposit√≥rios remotos de onde o Maven baixa as depend√™ncias.
build: Configura o processo de compila√ß√£o, empacotamento e testes do projeto.
profiles: (Opcional) Permite definir configura√ß√µes alternativas para diferentes ambientes (dev, teste, produ√ß√£o).
2. Gerenciamento de Depend√™ncias:
A se√ß√£o dependencies lista as depend√™ncias necess√°rias para o projeto.
Cada depend√™ncia √© declarada com elementos como groupId, artifactId, e version.
O Maven baixa automaticamente as depend√™ncias declaradas de reposit√≥rios centrais como o Maven Central.
√â importante especificar vers√µes compat√≠veis das depend√™ncias para evitar conflitos.
3. Ciclo de Vida do Projeto:
O pom.xml define o ciclo de vida do projeto Maven, que especifica comandos para tarefas espec√≠ficas: mvn clean: Limpa o diret√≥rio de sa√≠da do projeto. mvn compile: Compila o c√≥digo fonte do projeto. mvn test: Executa os testes de unidade do projeto. mvn package: Empacota o projeto em um artefato (por exemplo, JAR).
Voc√™ pode encontrar a lista completa de comandos do ciclo de vida na documenta√ß√£o do Maven.
4. Melhores Pr√°ticas:
Organize as depend√™ncias: Utilize sub-se√ß√µes como compile e test para organizar depend√™ncias usadas em diferentes fases do ciclo de vida.
Documenta√ß√£o: Inclua uma se√ß√£o description para descrever brevemente o projeto.
Propriedades: Use propriedades para valores reutiliz√°veis (e.g., vers√£o do projeto) para facilitar a manuten√ß√£o do pom.xml.
Plugins: O pom.xml permite configurar plugins do Maven para tarefas adicionais (gera√ß√£o de documenta√ß√£o, an√°lise est√°tica de c√≥digo).
5. Recursos para Aprender Mais:
Documenta√ß√£o Oficial do Maven: https://maven.apache.org/guides/index.html
Maven Tutorial: https://www.baeldung.com/maven-guide
Exemplos de pom.xml: https://maven.apache.org/pom.html
Seguindo essas dicas, voc√™ poder√° criar pom.xmls eficientes e f√°ceis de gerenciar para seus projetos Maven.

Bora codificar! üöÄ
Fernando Gabriel (Dev Samurai)